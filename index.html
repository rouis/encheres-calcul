<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur Ench√®res & Historique</title>
    <style>
        :root {
            --primary: #007bff;
            --success: #28a745;
            --bg: #f4f7f6;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 700px; margin: 20px auto; padding: 15px; background: var(--bg); color: #333; }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; }
        .section { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        h2 { margin-top: 0; font-size: 1.2rem; border-left: 4px solid var(--primary); padding-left: 10px; }
        
        label { display: block; margin-top: 10px; font-weight: 600; font-size: 0.9rem; }
        input, select { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-calc { background: var(--primary); color: white; }
        .btn-calc:hover { background: #0056b3; }
        
        .result-box { margin-top: 15px; padding: 15px; border-radius: 8px; display: none; }
        #resEnchere { background: #e7f1ff; border: 1px solid #b3d7ff; }
        #resGramme { background: #e9f7ef; border: 1px solid #c3e6cb; }

        /* Historique */
        .history-container { margin-top: 30px; }
        .history-header { display: flex; justify-content: space-between; align-items: center; }
        .btn-clear { background: #dc3545; color: white; padding: 5px 10px; font-size: 0.8rem; }
        .history-list { margin-top: 10px; }
        .history-item { background: white; padding: 12px; margin-bottom: 8px; border-radius: 8px; border-left: 4px solid #ccc; font-size: 0.9rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .history-item.enchere { border-left-color: var(--primary); }
        .history-item.or { border-left-color: var(--success); }
        .history-item b { color: #000; }
    </style>
</head>
<body>

    <h1>üõí Assistant Ench√®res</h1>

    <div class="section">
        <h2>üí∞ Calcul Frais de Vente</h2>
        <label>Prix adjug√© (‚Ç¨)</label>
        <input type="number" id="prix" placeholder="ex: 12000">
        
        <label>Frais (%)</label>
        <select id="pourcentage">
            <option value="14.4">14.4% (Alcopa / VPauto)</option>
            <option value="14.28">14.28% (Judiciaire)</option>
            <option value="25">25% (Volontaire / Art)</option>
            <option value="custom">Autre % personnalis√©</option>
        </select>
        <input type="number" id="customPct" placeholder="Entrez %" style="display:none; margin-top:10px;">

        <label>Frais fixes / Dossier (‚Ç¨)</label>
        <input type="number" id="fraisFixes" value="0">
        
        <button class="btn-calc" onclick="calculerEnchere()">Calculer et Ajouter</button>
        
        <div id="resEnchere" class="result-box"></div>
    </div>

    <div class="section">
        <h2>‚öñÔ∏è Calcul au Gramme</h2>
        <label>Prix total (‚Ç¨)</label>
        <input type="number" id="prixArt" placeholder="ex: 850">
        <label>Poids total (g)</label>
        <input type="number" id="poids" placeholder="ex: 15.4">
        
        <button class="btn-calc" style="background: var(--success);" onclick="calculerGramme()">Calculer et Ajouter</button>
        
        <div id="resGramme" class="result-box"></div>
    </div>

    <div class="history-container">
        <div class="history-header">
            <h3>üìú Historique des calculs</h3>
            <button class="btn-clear" onclick="viderHistorique()">Vider</button>
        </div>
        <div id="listeHistorique" class="history-list">
            </div>
    </div>

    <script>
        const select = document.getElementById('pourcentage');
        const customInput = document.getElementById('customPct');
        const historique = document.getElementById('listeHistorique');

        select.onchange = () => customInput.style.display = (select.value === 'custom') ? 'block' : 'none';

        function ajouterAHistorique(type, texte) {
            const div = document.createElement('div');
            div.className = `history-item ${type}`;
            div.innerHTML = `<span>${texte}</span> <small>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</small>`;
            historique.prepend(div); // Ajoute en haut de liste
        }

        function calculerEnchere() {
            const brute = parseFloat(document.getElementById('prix').value);
            const fixes = parseFloat(document.getElementById('fraisFixes').value) || 0;
            let pct = (select.value === 'custom') ? parseFloat(customInput.value) : parseFloat(select.value);

            if (!brute) return alert("Indiquez un prix");

            const montantPct = brute * (pct / 100);
            const total = brute + montantPct + fixes;

            document.getElementById('resEnchere').style.display = 'block';
            document.getElementById('resEnchere').innerHTML = `Total : <b>${total.toFixed(2)} ‚Ç¨</b> (Frais : ${(montantPct + fixes).toFixed(2)}‚Ç¨)`;
            
            ajouterAHistorique('enchere', `üöó Ench√®re: ${brute}‚Ç¨ + ${pct}% + ${fixes}‚Ç¨ = <b>${total.toFixed(2)} ‚Ç¨</b>`);
        }

        function calculerGramme() {
            const p = parseFloat(document.getElementById('prixArt').value);
            const w = parseFloat(document.getElementById('poids').value);

            if (!p || !w) return alert("Remplissez prix et poids");

            const ratio = p / w;
            document.getElementById('resGramme').style.display = 'block';
            document.getElementById('resGramme').innerHTML = `Prix au g : <b>${ratio.toFixed(2)} ‚Ç¨/g</b>`;
            
            ajouterAHistorique('or', `‚öñÔ∏è Objet: ${p}‚Ç¨ pour ${w}g = <b>${ratio.toFixed(2)} ‚Ç¨/g</b>`);
        }

        function viderHistorique() {
            if(confirm("Effacer tout l'historique ?")) historique.innerHTML = "";
        }
    </script>
</body>
</html>
